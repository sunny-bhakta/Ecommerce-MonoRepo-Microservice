## Variables
@customeremail=customer1@example.com
@customerpassword=Passw0rd!
@customertoken=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIyZDhiZDVlMS1iMTFiLTRhN2QtYmM2Mi03Mzk4MGE1MDAwM2UiLCJlbWFpbCI6ImFsaWNlQGV4YW1wbGUuY29tIiwicm9sZXMiOlsiY3VzdG9tZXIiXSwiaWF0IjoxNzY1NDQ4MDc5LCJleHAiOjE3NjgwNDAwNzl9.4sIaPuXeGD5aImuvT4zVSxQH9xWmqKG0eFzL6DEsncc
@adminemail=admin@example.com
@adminpassword=Passw0rd!
@adminfullname=Admin Example
@adminroles=["admin"]
@admintoken=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI5NTMwZTNlZS0zODQzLTRhZWUtODY2My01NTBjNWU3MjkwMTUiLCJlbWFpbCI6ImFkbWluQGV4YW1wbGUuY29tIiwicm9sZXMiOlsiYWRtaW4iXSwiaWF0IjoxNzY1Mzc0ODcyLCJleHAiOjE3Njc5NjY4NzJ9.vaZT3vwy8h0zlbJituCB_VZ4z8pUyhI2fDPtuExKfxs
@vendoremail=vendor1@example.com
@vendorpassword=Passw0rd!
@vendortoken=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2Y2VjZDZlNS03Y2JjLTQ5MGMtYjY4MS0wNGE4NTdiZjhhZTIiLCJlbWFpbCI6InZlbmRvcjFAZXhhbXBsZS5jb20iLCJyb2xlcyI6WyJ2ZW5kb3IiXSwiaWF0IjoxNzY2MTU4NjU5LCJleHAiOjE3Njg3NTA2NTl9.hIX6ghFLlcBg0W603TG2d7SLDRswnxHYj4xVqsTE0ik
@vendorfullname=Vendor Example
@vendorroles=["vendor"]
@orderId=bf11a4f9-33b4-4059-bb9f-63383fa93a40
@paymentId={{paymentId}}
@refundId={{refundId}}
@shipmentId={{shipmentId}}
@productId=694267746da85e335a182fd2
@categoryId=6942656c6da85e335a182fcc
@subcategoryId=694d06cb43e32999576a8a7f
@warehouseId=693a8ccb2a9805d132b75df9
@userId={{userId}}
@vendorId={{vendorId}}
@reviewId=6942ccbbe63dd4b76e5bea8b
@actionId=6943d3111e4a7666a2228a6e
@gatewayurl=http://localhost:3000

# Auth Service Via Gateway
### Health
GET {{gatewayurl}}/auth/health

### Vendor Register (example)
POST {{gatewayurl}}/auth/vendor/register
Content-Type: application/json

{
  "email": "{{vendoremail}}",
  "password": "{{vendorpassword}}",
  "fullName": "{{vendorfullname}}",
  "roles": {{vendorroles}}
}

### Customer Register (example)
POST {{gatewayurl}}/auth/customer/register
Content-Type: application/json

{
  "email": "{{customeremail}}",
  "password": "{{customerpassword}}",
  "fullName": "Customer2 Adae",
  "roles": ["customer"]
}

### Customer Login
POST {{gatewayurl}}/auth/login
Content-Type: application/json

{
  "email": "{{customeremail}}",
  "password": "{{customerpassword}}"
}


### Vendor Login
POST {{gatewayurl}}/auth/login
Content-Type: application/json

{
  "email": "{{vendoremail}}",
  "password": "{{vendorpassword}}"
}


### Current User (admin / vendor / customer)
GET {{gatewayurl}}/auth/me
Authorization: Bearer {{vendortoken}}










### Current User (admin / vendor / customer)
GET http://localhost:3010/auth/me
Authorization: Bearer {{vendortoken}}

### Change Password
# PATCH http://localhost:3010/auth/password
PATCH {{gatewayurl}}/auth/password
Content-Type: application/json
Authorization: Bearer {{vendortoken}}

{
  "currentPassword": "{{vendorpassword}}",
  "newPassword": "{{vendorpassword}}"
}

### Admin - List Users
GET {{gatewayurl}}/auth/users
Authorization: Bearer {{admintoken}}


## Gateway (port 3000) â€” primary entrypoint
> All business operations below are routed through the API gateway (`http://localhost:3000`). Do not call downstream services directly from clients.

### Health
GET http://localhost:3000/health

### Catalog
#### Health
GET http://localhost:3000/catalog/health


#### Create category (admin)
POST http://localhost:3000/catalog/categories
Content-Type: application/json
Authorization: Bearer {{admintoken}}

{ "name": "Shoes" }

#### Create sub-category (admin)
# POST http://localhost:3000/catalog/categories
POST http://localhost:3040/catalog/categories
Content-Type: application/json
Authorization: Bearer {{admintoken}}

{
  "name": "Running Shoes",
  "parentId": "{{categoryId}}"
}

#### Create sub-sub-category (admin)
# Update @subcategoryId (top of file) with the ID returned from the sub-category creation response before running this request.
# POST http://localhost:3000/catalog/categories
POST http://localhost:3040/catalog/categories
Content-Type: application/json
Authorization: Bearer {{admintoken}}

{
  "name": "Marathon Running",
  "parentId": "{{subcategoryId}}"
}

#### List categories
# GET http://localhost:3000/catalog/categories
GET http://localhost:3040/catalog/categories

#### List category tree (all nested levels)
# GET http://localhost:3000/catalog/categories/tree
GET http://localhost:3040/catalog/categories/tree

#### Create product (admin)
POST http://localhost:3000/catalog/products
Content-Type: application/json
Authorization: Bearer {{admintoken}}

{
  "name": "Running Shoe",
  "categoryId": "{{categoryId}}",
  "basePrice": 99.5,
  "attributes": [{ "key": "brand", "value": "Acme" }],
  "options": [
    { "name": "color", "values": ["red", "blue"] },
    { "name": "size", "values": ["41", "42", "43"] }
  ],
  "variants": [
    {
      "sku": "SKU-RED-41",
      "price": 109.99,
      "stock": 10,
      "attributes": [{ "key": "color", "value": "red" }, { "key": "size", "value": "41" }]
    }
  ]
}

#### Create product (vendor, goes pending)
POST http://localhost:3000/catalog/products
Content-Type: application/json
Authorization: Bearer {{vendortoken}}

{
  "name": "Vendor Item",
  "categoryId": "{{categoryId}}",
  "basePrice": 49.99,
  "attributes": [{ "key": "brand", "value": "VendorBrand" }]
}

#### List products (public; only approved returned)
GET http://localhost:3000/catalog/products

#### List products by vendor (admin view with status filter)
GET http://localhost:3000/catalog/products?vendorId={{vendorId}}&status=pending
Authorization: Bearer {{admintoken}}

#### List my products (vendor)
GET http://localhost:3000/catalog/my-products
Authorization: Bearer {{vendortoken}}

#### Approve/reject product (admin)
PATCH http://localhost:3000/catalog/products/{{productId}}/status
Content-Type: application/json
Authorization: Bearer {{admintoken}}

{ "status": "approved" }

#### Update product details (admin/vendor)
PATCH http://localhost:3000/catalog/products/{{productId}}
Content-Type: application/json
Authorization: Bearer {{vendortoken}}

{
  "name": "Updated Running Shoe",
  "description": "Now with better cushioning",
  "basePrice": 119.5,
  "attributes": [{ "key": "brand", "value": "Acme" }],
  "options": [
    { "name": "color", "values": ["red", "blue", "black"] },
    { "name": "size", "values": ["41", "42", "43", "44"] }
  ]
}

#### Get product by id
GET http://localhost:3000/catalog/products/{{productId}}

#### Add variant to product (admin)
POST http://localhost:3000/catalog/products/{{productId}}/variants
Content-Type: application/json
Authorization: Bearer {{admintoken}}

{
  "sku": "SKU-BLUE-42",
  "price": 109.99,
  "stock": 10,
  "attributes": [
    { "key": "color", "value": "blue" },
    { "key": "size", "value": "42" }
  ]
}

#### Add variant to product (vendor)
POST http://localhost:3000/catalog/products/{{productId}}/variants
Content-Type: application/json
Authorization: Bearer {{vendortoken}}

{
  "sku": "SKU-BLUE-42",
  "price": 109.99,
  "stock": 10,
  "attributes": [
    { "key": "color", "value": "blue" },
    { "key": "size", "value": "42" }
  ]
}

#### List variants for product
GET http://localhost:3000/catalog/products/{{productId}}/variants

### Update product (admin) and vendor
PATCH http://localhost:3000/catalog/products/{{productId}}
Content-Type: application/json
Authorization: Bearer {{vendortoken}}

{
  "name": "Running Shoe Updated",
  "basePrice": 119.99,
  "options": [
    { "name": "color", "values": ["red", "blue", "green"] },
    { "name": "size", "values": ["41", "42", "43", "44"] }
  ]
}

### Inventory (admin)
#### Create Warehouse
POST http://localhost:3000/warehouses
Content-Type: application/json
Authorization: Bearer {{admintoken}}

{ "name": "WH-1", "location": "NY" }

#### Manage stock
POST http://localhost:3000/inventory/stock
Content-Type: application/json
Authorization: Bearer {{admintoken}}

{ "sku": "SKU-BLUE-42", "warehouseId": "{{warehouseId}}", "onHand": 50 }

#### Reserve stock
POST http://localhost:3000/inventory/reserve
Content-Type: application/json
Authorization: Bearer {{admintoken}}

{ "sku": "SKU-BLUE-42", "warehouseId": "{{warehouseId}}", "quantity": 2 }

#### Get inventory by SKU
GET http://localhost:3000/inventory/SKU-BLUE-42

### Orders, payments, and shipments
#### Checkout (create order + payment intent/order)
POST http://localhost:3000/checkout
Content-Type: application/json
Authorization: Bearer {{customertoken}}

{
  "currency": "INR",
  "items": [
    {
      "productId": "{{productId}}",
      "sku": "SKU-BLUE-42",
      "quantity": 2,
      "price": 109.99
    }
  ],
  "notes": "Deliver quickly",
  "paymentProvider": "razorpay",
  "shippingAddress": "1-221B Baker Street" 

}

#### List my orders
GET http://localhost:3000/orders
Authorization: Bearer {{customertoken}}

#### List vendor orders (vendor sees only their items)
GET http://localhost:3000/orders
Authorization: Bearer {{vendortoken}}

#### Order detail / summary
GET http://localhost:3000/orders/{{orderId}}/summary
Authorization: Bearer {{customertoken}}

#### Cancel order (pre-fulfillment)
PATCH http://localhost:3000/orders/{{orderId}}/cancel
Authorization: Bearer {{customertoken}}

#### List order payments
GET http://localhost:3000/orders/{{orderId}}/payments
Authorization: Bearer {{customertoken}}

#### Request refund for a payment
POST http://localhost:3000/orders/{{orderId}}/payments/{{paymentId}}/refunds
Content-Type: application/json
Authorization: Bearer {{customertoken}}

{
  "amount": 100.0,
  "reason": "duplicate"
}

#### List refunds for a payment
GET http://localhost:3000/orders/{{orderId}}/payments/{{paymentId}}/refunds
Authorization: Bearer {{customertoken}}

#### List shipments for an order
GET http://localhost:3000/orders/{{orderId}}/shipments
Authorization: Bearer {{customertoken}}

#### Track a shipment (customer)
GET http://localhost:3000/shipments/{{shipmentId}}
Authorization: Bearer {{customertoken}}

#### Create shipment (admin)
POST http://localhost:3000/shipments
Content-Type: application/json
Authorization: Bearer {{admintoken}}

{
  "orderId": "{{orderId}}",
  "carrier": "dhl",
  "destination": "123 Main St, City",
  "trackingNumber": "TRK123"
}

#### List shipments (optional order filter)
GET http://localhost:3000/shipments?orderId={{orderId}}
Authorization: Bearer {{admintoken}}

#### Update shipment status (admin)
PATCH http://localhost:3000/shipments/{{shipmentId}}/status
Content-Type: application/json
Authorization: Bearer {{admintoken}}

{ "status": "in_transit", "trackingNumber": "TRK123" }

#### Shipping service health (downstream)
GET http://localhost:3080/health

### Test (payments service, optional)
# POST http://localhost:3070/payment/payments
# Content-Type: application/json
# Authorization: Bearer {{customertoken}}
#
# {
#   "currency": "INR",
#   "orderId": "{{orderId}}",
#   "userId": "2d8bd5e1-b11b-4a7d-bc62-73980a50003e",
#   "amount": 219.98,
#   "status": "pending",
#   "provider": "razorpay"
# }

### Users (via gateway)
#### Create user (admin)
POST http://localhost:3000/users
Content-Type: application/json
Authorization: Bearer {{admintoken}}

{
  "email": "alice@example.com",
  "fullName": "Alice Smith",
  "phoneNumber": "+1-555-0101",
  "addresses": [
    {
      "label": "home",
      "line1": "1-221B Baker Street",
      "city": "London",
      "country": "UK",
      "postalCode": "NW16XE",
      "isDefault": true
    },
    {
      "label": "office",
      "line1": "221B Baker Street",
      "city": "London",
      "country": "UK",
      "postalCode": "NW16XE"
    }
  ]
}

#### List users (admin)
GET http://localhost:3000/users
Authorization: Bearer {{admintoken}}

#### List users filtered by email (admin)
GET http://localhost:3000/users?email={{adminemail}}
Authorization: Bearer {{admintoken}}

#### Get user by id (admin)
GET http://localhost:3000/users/{{userId}}
Authorization: Bearer {{admintoken}}

#### Update user (admin)
PATCH http://localhost:3000/users/{{userId}}
Content-Type: application/json
Authorization: Bearer {{admintoken}}

{
  "fullName": "Bob The Builder",
  "isActive": true
}

#### Delete user (admin)
DELETE http://localhost:3000/users/{{userId}}
Authorization: Bearer {{admintoken}}

### My profile (self-service)
#### Get my profile
GET http://localhost:3000/me/profile
Authorization: Bearer {{customertoken}}

#### Update my profile
PATCH http://localhost:3000/me/profile
Content-Type: application/json
Authorization: Bearer {{customertoken}}

{
  "fullName": "Alice Updated",
  "phoneNumber": "+91-9876543210",
  "dateOfBirth": "1990-01-01",
  "preferences": {
    "language": "en",
    "currency": "INR",
    "newsletterSubscribed": true
  }
}

### Vendor (admin)
POST http://localhost:3000/vendors
Content-Type: application/json
Authorization: Bearer {{admintoken}}

{
  "name": "Acme Corp",
  "email": "vendor@example.com",
  "companyName": "Acme Corp Ltd",
  "gstNumber": "GST12345"
}

### Search (admin index + public query)
POST http://localhost:3000/search/index
Content-Type: application/json
Authorization: Bearer {{admintoken}}

{
  "id": "doc-1",
  "title": "Red Running Shoe",
  "description": "Lightweight shoe",
  "tags": ["shoe","running"],
  "type": "product",
  "metadata": {
    "price": 119.99,
    "currency": "USD",
    "categoryId": "shoes",
    "image": "https://cdn.example.com/red-running-shoe.jpg"
  }
}

### Seed dummy search data (admin)
POST http://localhost:3000/search/seed
Content-Type: application/json
Authorization: Bearer {{admintoken}}

{}

### Query search
POST http://localhost:3000/search/query
Content-Type: application/json

{ "query": "shoe", "tags": ["running"], "type": "product" }

### Get document by id
GET http://localhost:3000/search/documents/doc-1

### Reviews
POST http://localhost:3000/reviews
Content-Type: application/json
Authorization: Bearer {{customertoken}}

{
  "targetId": "{{productId}}",
  "targetType": "product",
  "rating": 5,
  "comment": "Great!"
}


### Flag a review
PATCH http://localhost:3000/reviews/{{reviewId}}/flag
Content-Type: application/json
Authorization: Bearer {{customertoken}}

{ "reason": "spam" }

### Moderate review (admin)
PATCH http://localhost:3000/reviews/{{reviewId}}/moderate
Content-Type: application/json
Authorization: Bearer {{admintoken}}

{ "status": "approved", "moderatorNote": "ok" }

### List reviews for a product
GET http://localhost:3000/reviews?targetId={{productId}}&targetType=product

### Analytics
POST http://localhost:3000/analytics/events
Content-Type: application/json
Authorization: Bearer {{customertoken}}

{ "type": "order", "amount": 199.99, "currency": "INR", "status": "created" }

### Get aggregated metrics
GET http://localhost:3000/analytics/metrics
Authorization: Bearer {{admintoken}}

### Admin actions
POST http://localhost:3000/admin/actions
Content-Type: application/json
Authorization: Bearer {{admintoken}}

{
  "targetType": "review",
  "targetId": "66fb4e91d9f2d8d5c6ed1234",
  "actionType": "review_moderation",
  "note": "Review contains spam links; awaiting moderation decision."
}

### Update admin action status
# {
#   "targetType": "review",
#   "targetId": "{{reviewId}}",
#   "actionType": "review_moderation",
#   "note": "check content"
# }

PATCH http://localhost:3000/admin/actions/{{actionId}}
Content-Type: application/json
Authorization: Bearer {{admintoken}}

{ "status": "completed", "resolutionNote": "approved" }

### Notifications (Python service via gateway)
POST http://localhost:3000/notifications
Content-Type: application/json
Authorization: Bearer {{customertoken}}

{
  "channel": "email",
  "to": "user@example.com",
  "title": "Hello",
  "body": "Welcome!",
  "metadata": { "foo": "bar" }
}

POST http://localhost:3000/notifications/webpush/register
Content-Type: application/json
Authorization: Bearer {{customertoken}}

{
  "endpoint": "https://push.example/123",
  "p256dh": "key",
  "auth": "authkey"
}

